# Windows Malware

Windows is the most popular OS.

Malware interacts with OS via API to execute code.

## Windows API

- Windows uses its own naming method to represent data types in the C programming language
- `WORD` = 16 bits unsigned value <sub><sup>(2 bytes)</sub></sup>
- `DWORD` = 32 bits unsigned value <sub><sup>(4 bytes)</sub></sup>
- Handles = ?
- Long Pointer = ?
- Callback = represents a function that will be called by the Windows API
- also uses Hungarian Notation for API function identifiers

### Hungarian Notation  

- Something like Camel Case , looking at the function name will depict the code's purpose
- eg. `CreateFile` / `ReadFile` / `WriteFile` - it does what its name states

### :thought_balloon: Handles

- Handles are items that has been opened by the OS
- Handles are like pointers and point to a location in memory
- Can store handle for later use
- Cannot perform arithmetic operations on handles

## File API

### :thought_balloon: File System Functions

- `CreateFile`
  - Can open existing files, pipes, streams & I/O devices

- `ReadFile` / `WriteFile`
  - Used to read/write to files
  - When called, the function will read the first n number of bytes of the file. When called again, the next n number of bytes of the file will be read.

- `CreateFileMapping` / `MapViewOfFile`
  - Something placeholder here.
  
## Windows Registry

- Used to store OS and program configuration info (eg. settings)
- Good source of host-based indicator
- Hierarchical database for info
  
### :thought_balloon: Registry Terms

#### Root Keys

#### Common Registry Functions

#### Registry Tools

1. Regedit
2. Autoruns
3. Regshot
  
## Networking API

- Programs uses socket (establish connection with remote connection) to listen & send data to the network

- Network sniffers :thought_balloon:
  - The following code creates a undetected network sniffer :
  - ??

- WinINET API :thought_balloon:
  - higher level API that implements some higher level protocols
  - API in relation to internet

- Downloaders :thought_balloon:
  - ??

!!! tip "Anand's tip corner"

    * If you want to know more details on certain functions, refer to the documentation
      * One useful link he showed! : [MSDN library](https://learn.microsoft.com/en-us/)
