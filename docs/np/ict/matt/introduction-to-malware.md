# Introduction to Malware

## Defining Malware

**Malware = Malicious Software/Software created with Malicious Intent**

### Usage

- used to compromise computer functions
- steal data >:)
- bypass access controls
- cause harm to the host computer

### Malware Symptoms

1. Increased CPU Usage
2. Slow computer/web browser speeds
3. Problems connecting to network
4. Freezing or crashing
5. Modified or deleted files
6. Appearance of strange files/programs/desktop icons
7. Programs running, turning off, or reconfiguring themselves <sub><sup>(malwares often reconfigure/turn off antivirus/firewall programs)</sub></sup>
8. Strange computer behavior
9. Emails/Messages being sent automatically without user's knowledge.

### Types of 'wares

#### Adwares

- Type of malware that automatically delivers advertisements
- Usually more annoying than bringing harm/danger to the host computer
- Examples
- pop-up ads on websites (on static sites/software downloading websites)

#### Bots <sub><sup>(aka Botnet too)</sub></sup>

- Typically a network with zombie computers
- Created to automatically perform specific operations - online video gaming / internet auctions / online contests
- Some bots dangerous ^

#### Bugs

- Is a flaw that produces an undesired outcome <sub><sup>(because bug can be exploited)</sub></sup>
- Security bugs are the most severe type of bugs as it can allow attackers to easily infiltrate or take control of the device.
- Eg. SQL/XSRF/XSS

#### Ransomwares

- Form of malware that holds a computer system captive while demanding a ransom
- Enters your hard disk, demands for money(ransom) every time the computer is booted up
- Can classify into two themes - can be a virus or a worm
- Started as a virus, before it became a worm.
- Examples:
  - [Petya - a virus ransomware](https://www.cloudflare.com/learning/security/ransomware/petya-notpetya-ransomware/)
  - [Wannacry - a worm ransomware](https://www.kaspersky.com/resource-center/threats/ransomware-wannacry)

!!! info "Petya vs NotPetya"

    Petya - virus

    NotPetya - worm.

#### Rootkits

- Type of malicious software designed to remotely access/control a computer without being detected by users or security programs.

#### Spywares

- Type of malware that functions by spying on user activity without their knowledge

- Capabilities can include:
  - Activity monitoring
  - Collecting keystrokes
  - Data harvesting

#### Trojan horses

- Type of malware that disguises itself as a normal file/program to trick users into downloading and installing malware

#### Cryptojackers

- Crypto mining requires a lot of a CPU, so hackers "borrow" your computer's resources
- Hides on your device and steals its computing resources in order to mine for valuable online currencies like Bitcoin.

#### Viruses

- Malware that is capable of copying itself and spreading to other computers
- Often spread to other computesr by attaching themselves to various programs
- Executes code when a user launches one of those infected programs

#### Worms

- Spread over computer networks by exploiting OS vulnerability
- Typically harm their host networks by consuming bandwidth and overloading web servers

## Malware Analysis Techniques <sub><sup>(brief introduction)</sub><sup>

### Basic Static Analysis

- Not executing the malware
- Used to look for dependencies (`dll` files), strings

### Basic Dynamic Analysis

- Observation of the malware when it is executed
- Involves running the malware and observing its behavior

### Advanced Static Analysis

- Consists of reverse-engineering the malware's internals by loading the executable into disassembler and looking at the program's code in order to discover what the program does <sub><sup>(what is it's purpose/target?)</sub></sup>
- Steeper Learning curve, requires specialized knowledge of disassembly, code constructs, and Windows OS concepts

### Advanced Dynamic Analysis

- Reverse Engineering. Executes the code and goes through the code line by line, by setting breakpoints
- Uses a debugger to examine the internal state of a running malicious executable
- Provides another way to extract detailed information from an executable
- Most useful technique when trying to obtain information that is difficult to gather with the other techniques

## Packed malwares

A malicious actor would like to add as many roadblocks to the investigation as possible. One way to achieve this is using a packer.

A packer is a program that takes a malicious program and adds a layer of obfuscation (i.e. encryption) to it. This makes it harder to analyze the program and to detect it.

The program would then be unpacked when it is executed. This is done by the unpacker. The unpacker is a program that decrypts the malicious program.

!!! tip "How to identify packed malware"

    * Raw size > virtual size.

## Ordinal values

The ordinal values are the numbers that are used to identify the functions in the Windows API. The ordinal values are used in the import table of the PE file.

In static analysis, ordinal values are not available because the program is not running. The ordinal values are only available in dynamic analysis.
